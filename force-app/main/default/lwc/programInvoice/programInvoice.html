<template>
	<lightning-card variant="base">
		<c-error-panel
			errors={error}
			type="banner">
		</c-error-panel>
		<div
			lwc:if={isLoading}
			style="height: 200px; position: relative">
			<lightning-spinner
				alternative-text="Loading"
				size="medium"
				variant="brand">
			</lightning-spinner>
		</div>
		<div lwc:else>
			<div class="container">
				<template
					lwc:if={cartProducts}
					for:each={cartProducts}
					for:item="product">
					<div
						key={product.Id}
						class="products">
						<div>{product.Name}</div>
						<lightning-formatted-number
							class="slds-m-left--small"
							value={product.Price__c}
							format-style="currency"
							currency-code="USD">
						</lightning-formatted-number>
					</div>
				</template>
				<div class="products total">
					<div>Total</div>
					<div>{total}</div>
				</div>
				<div lwc:if={paymentFrequency}>
					<lightning-combobox
						class="rest"
						name="payFrequency"
						label="Payment Frequency"
						value={frequency}
						options={paymentFrequency}
						required
						onchange={selectFrequencyOption}>
					</lightning-combobox>
				</div>
				<div
					class="credits"
					lwc:if={credits}>
					<template
						lwc:if={credits}
						for:each={credits}
						for:item="credit">
						<div
							key={credit.Id}
							class="creditLine">
							<div>Apply my credit of ${credit.available}</div>
							<lightning-input
								type="checkbox"
								name={credit.type}
								data-id={credit.Id}
								value={credit.available}
								onchange={clickCreditBox}></lightning-input>
						</div>
					</template>
				</div>
				<div class="rest btns">
					<lightning-button
						variant="brand"
						name="pay"
						label="Pay"
						onclick={clickPayBtn}
						disabled={lockBtns}>
					</lightning-button>
				</div>
				<c-payment-processor
					cart-data={cart}
					payment-type={frequency}
					credits={appliedCredits}
					onsenttocheckout={sentToCheckout}>
				</c-payment-processor>
			</div>
		</div>
	</lightning-card>
</template>
